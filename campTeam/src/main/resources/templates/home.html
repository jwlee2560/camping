<!DOCTYPE html>
<!-- thymeleaf dialect -->
<html lang="ko-kr" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout}">

<head>
<meta charset="UTF-8">
<title>home</title>

<!--slick slider 필요 태그 st-->
<link rel="stylesheet" type="text/css"
	href="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css" />
<link rel="stylesheet" type="text/css"
	href="//cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.5.8/slick-theme.min.css">
<!-- jQuery CDN -->
<script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
<script src="https://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
<!-- slick Carousel CDN -->
<script type="text/javascript"
	src="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>
<!--slick slider 필요 태그 en-->

<link th:href="@{'/css/home.css'}" rel="stylesheet" />


</head>

<body>

	<div layout:fragment="content" class="main_sect_pnl">

		<div class="mb-5"
			style="background-image: url('/campTeam/img/main1.jpg'); background-repeat: no-repeat; width: 100%; height: 550px;">

			<!--타이틀-->
			<div class="w-100 d-flex justify-content-center align-items-center"
				style="height: 200px;">
				<h3 class="mt-2"
					style="color: #fff; font-size: 65px; font-family: Black Han Sans;">'CAMPING'하자</h3>
			</div>
			<!--//타이틀-->

			<div class="border border-secondary my-5 w-75 mx-auto">

				<!-- <form th:action="@{/mapSearch}" method="get"> -->

				<div class="row w-100 ps-0">

					<ul class="row mb-2 list-unstyled list-group list-group-horizontal">

						<li class="col-6 pt-2 mt-2 ms-4 ps-4 me-0 px-0"><strong
							style="color: #fff;">지역</strong>
							<div class="mt-3 mx-0 px-0">
								<select id="region" name="region" class="form-select">
									<option>경기 북부</option>
									<option>경기 남부</option>
								</select>
							</div></li>

						<li class="col-5 pt-2 mt-2 ms-5 me-0 px-0"><strong
							style="color: #fff;">주변시설</strong>
							<div class="mt-3 mx-0 px-0">
								<select id="thema" name="thema" class="form-select">
									<option>체험시설</option>
									<option>계곡</option>
									<option>낚시</option>
									<option>놀이시설</option>
									<option>수영장</option>
									<option>산책로</option>
									<option>수상레저</option>
									<option>해당없음</option>
								</select>
							</div></li>
					</ul>
				</div>

				<div class="row mx-auto mt-1 mb-5 ps-3">
					<ul class="list-unstyled">
						<li class="mt-2" style="color: #fff;"><strong>키워드 검색</strong></li>
					</ul>
					<div class="flex justify-content-center col-6">
						<input type="text" id="searchWord" name="searchWord"
							class="form-control" placeholder="검색어를 입력하세요.">
					</div>
					<div class="flex justify-content-center col-3">
						<button id="search-btn" class="btn btn-secondary" type="button">캠핑장
							검색</button>
					</div>
				</div>

				<!--  </form> -->

			</div>


		</div>



		<div class="section_05">
			<div class="layout">
				<div class="title_w">
					<h2 class="tt01">추천 검색 결과</h2>
				</div>
			</div>


			<div class="thema_bg_w2">
				<div class="thema_bg_01">
					<img src="img/thema_bg_01.jpg" alt="추천 배경 이미지">
				</div>
			</div>



			<!-- 테마 슬라이드 ver1-->

			<div class="d-flex justify-content-center">
				<div class="post-slider">
					<div class="post-wrapper"></div>
				</div>
			</div>

		<!-- 	<script th:src="@{'/js/home.js'}"></script> -->
			<script>
			$(function() {

				$('.post-wrapper').slick({
			        slidesToShow: 3, //한번에 보여줄 슬라이드 갯수
			        slidesToScroll: 1, //한번에 넘겨지는 슬라이드 갯수
					autoplay: true,
					autoplaySpeed: 500,
			        arrows: true, //넘기기 버튼 화살표 여부
			        dots:true, //네비게이션 버튼 dot유형
			        asNavFor: '.terms-nav', //함께 움직이는 슬라이드 메뉴영역
			        infinite: false, //무한반복 옵션
			        adaptiveHeight: true, // 슬라이더 높이를 현재 슬라이드에 맞춤
			        draggable:false //드래그 가능여부
			      });

					// 도입부 슬라이드(가평 10개)
						$.ajax({
							method : 'get',
							url : '/campTeam/mapRest',
							data : {
								region :"경기 북부",
								thema :"해당없음",
								searchWord :"가평"
							}
						})
						.done(function(response, status, xhr) {

							if (status == "nocontent") {

								alert("해당 정보가 없습니다.");

							} else if (status == 'success') {

								console.log("response : ", response);

								let camps="";

								for (var i=0; i<response.length; i++) {

									console.log("캠프장-1 : ", response[i]);

									 camps += `
											<div class="post"><img src="img/thumb_324_224_7068XomaEU0GHukSA6oTW0PD.jpeg" class="slider-image">
											   <div class="post-info">
											   <h4><a href="#">${response[i].campName}</a></h4>
											   <i class="far fa-user" style="height:10%; width:300px; overflow-wrap: break-word;">
											   ${response[i].facilDetail.substring(0,30)}...</i>
											   </div>
										   </div>`;
								} // for

								$(".post-wrapper").html(camps);

								$('.post-wrapper').slick("unslick").slick();

							} // success (http status 200)

						}) // done
						.fail(function(data, status, xhr) { // 요청에 대한 응답 실패시

							// alert(data.status);
							alert("서버에 문제가 발생하였습니다.");
							console.log("data : ", data);
							console.log("상태 코드 : ", data.status);
							console.log("xhr : ", xhr);
						}) // ajax


					// https://developers.kakaomobility.com/docs/navi-api/directions/
					//
					// curl -v -X GET "https://apis-navi.kakaomobility.com/v1/directions?origin=127.11015314141542,37.39472714688412&destination=127.10824367964793,37.401937080111644&waypoints=&priority=RECOMMEND&car_fuel=GASOLINE
					//			&car_hipass=false&alternatives=false&road_details=false"
					//	 -H "Authorization: KakaoAK KAKAO REST API KEY"
					console.log("테스트");

					let region = document.getElementById("region");
					let thema = document.getElementById("thema");
					let searchWord = document.getElementById("searchWord");

					console.log("지역:",region.value)
					console.log("테마:",thema.value)
					console.log("검색어:",searchWord.value)

					///////////////////////////////////////////////////////////////

					$("#search-btn").click(function(e) {

						alert("전송")

						$.ajax({
							method : 'get',
							url : '/campTeam/mapRest',
							data : {
								region : $('#region').val(),
								thema : $("#thema").val(),
								searchWord : $('#searchWord').val()
							}
						})
						.done(function(response, status, xhr) {

							alert("성공");

							if (status == "nocontent") {

								alert("해당 정보가 없습니다.");

							} else if (status == 'success') {

								console.log("response : ", response);
								console.log("response.length : ", response.length);

								var camps="";

								// 슬라이드 초기화 (중요!)
								// 기존 슬라이드들 제거 : 패치
							    $('.post-wrapper').slick('slickRemove', null, null, true);

								// $('.post-wrapper').slick("unslick").slick();

								for (var i=0; i<response.length; i++) {

									console.log("캠프장-1 : ", response[i]);
									console.log("캠프장-1 위도 : ", response[i].latitude);
									console.log("캠프장-1 경도 : ", response[i].longitude);

									 camps += `
											<div class="post"><img src="img/thumb_324_224_7068XomaEU0GHukSA6oTW0PD.jpeg" class="slider-image">
											   <div class="post-info">
											   <h4><a href="#">${response[i].campName}</a></h4>
											   <i class="far fa-user" style="height:10%; width:300px; overflow-wrap: break-word;">
											   ${response[i].facilDetail.substring(0,30)}...</i>
											   </div>
										   </div>`;
			 					} // for

								$(".post-wrapper").html(camps);
								$('.post-wrapper').slick("unslick").slick();

							} // success (http status 200)

						}) // done
						.fail(function(data, status, xhr) { // 요청에 대한 응답 실패시

							// alert(data.status);
							alert("서버에 문제가 발생하였습니다.");
							console.log("data : ", data);
							console.log("상태 코드 : ", data.status);
							console.log("xhr : ", xhr);
						})// ajax

					////////////////////////////////////////////////////////
				});//$("#search-btn").click(function(e) {

			});
			</script>
			<!--post slider-->
		</div>
	</div>

</body>
</html>