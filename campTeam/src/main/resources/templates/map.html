<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"/>
	<title>Kakao 지도 시작하기</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
	<script>
	$(function() {

		$("#searchBtn").click(function() {

			alert("클릭");

			$.ajax({
				method : 'get',
				url : '/campTeam/mapRest',
				data : {
					region : $('#region').val(),
					thema : $("#thema").val(),
					searchWord : $('#searchWord').val()
				}
			})
			.done(function(response, status, xhr) {

				alert(status);

				if (status == "nocontent") {

					alert("해당 정보가 없습니다.");

				} else if (status == 'success') {

					console.log("response : ", response);
					console.log("캠프장-1 : ", response[0]);
					console.log("캠프장-1 위도 : ", response[0].latitude);
					console.log("캠프장-1 경도 : ", response[0].longitude);

					var container = document.getElementById('map');

					var options = {
						center: new kakao.maps.LatLng(response[0].latitude, response[0].longitude),
						level: 8
					};

					var map = new kakao.maps.Map(container, options);

					// 다중 마커 표시
					var positions = [];

					// 마커 이미지
					var imageSrc = "https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/markerStar.png";

					 // 마커 이미지의 이미지 크기 입니다
				    var imageSize = new kakao.maps.Size(24, 35);

				    // 마커 이미지를 생성합니다
				    var markerImage = new kakao.maps.MarkerImage(imageSrc, imageSize);

				    let camp = { title : '', latlng : '' };

					for (var i=0; i<response.length; i++) {

						camp.title = response[i].campName;
						camp.latlng = new kakao.maps.LatLng(response[i].latitude, response[i].longitude);

						positions[i] = camp;

					    // 마커 생성
					    var marker = new kakao.maps.Marker({
					        map: map, // 마커를 표시할 지도
					        position: positions[i].latlng, // 마커를 표시할 위치
					        title : positions[i].title, // 마커의 타이틀, 마커에 마우스를 올리면 타이틀이 표시됩니다
					        image : markerImage // 마커 이미지
					    });

					} // for
				} // success (http status 200)

			}) // done
			.fail(function(data, status, xhr) { // 요청에 대한 응답 실패시

				// alert(data.status);
				alert("서버에 문제가 발생하였습니다.");
				console.log("data : ", data);
				console.log("상태 코드 : ", data.status);
				console.log("xhr : ", xhr);
			})
		}); // ajax
	});
	</script>
</head>
<body>

	<div id="map" style="width:1300px; height:500px;"></div>

	<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=902b7b97c1c375075b85e37ed1d667bf&libraries=services"></script>
	<script>
		var container = document.getElementById('map');
		var options = {
			// 기본값 : 신림역
			center: new kakao.maps.LatLng(37.484269, 126.929676),
			level: 1
		};

		var map = new kakao.maps.Map(container, options);
	</script>

	<div style="margin-top:20px;">

		지역 : <select id="region" name="region">
		      	<option>서울/경기/인천 전체</option>
		      	<option>경기 북부</option>
		      	<option>경기 남부</option>
			  </select>

			  <br><br>

		테마 : <select id="thema" name="thema">
				<option>바다</option>
				<option>강</option>
				<option>낚시</option>
				<option>산책</option>
				<option>수상레저</option>
			  </select>

  			  <br><br>

		검색어 : <input type="text" id="searchWord" name="searchWord" placeholder="해당 지역을 입력하십시오. 예) 평택"/>

			  <br><br>

		<button id="searchBtn" type="button">전송</button>
	</div>

</body>
</html>